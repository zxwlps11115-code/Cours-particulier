<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cours particuliers — Section internationale (Japonais)</title>
  <meta name="description" content="Cours particuliers en japonais — professeurs natifs et bilingues. Design animé premium." />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg-1:#071029;--bg-2:#071427;
      --glass: rgba(255,255,255,0.04);--muted:#9aa4b2;
      --accent-start:#ff7a7a;--accent-end:#ffd36b;
      --accent-blue-start:#6ee7b7;--accent-blue-end:#60a5fa;
      --card-grad: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      --radius:16px;--glass-border: rgba(255,255,255,0.06);--max-width:1100px;
      --shadow-strong: 0 20px 60px rgba(2,6,23,0.8);--glass-blur: 10px;
      --container-pad:20px;
    }
    *{box-sizing:border-box}
    /* fix iOS text auto-zoom behaviour */
    html { -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background: linear-gradient(180deg,var(--bg-1) 0%, var(--bg-2) 100%);color:#e6eef6;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-y:auto;padding-bottom:env(safe-area-inset-bottom,0)}
    .container{max-width:var(--max-width);margin:0 auto;padding:28px var(--container-pad);width:100%;box-sizing:border-box;min-height:100vh}

    /* Background cinematic */
    .bg-anim{position:fixed;inset:0;z-index:-2;pointer-events:none;overflow:hidden;background: radial-gradient(1200px 600px at 10% 10%, rgba(96,165,250,0.06), transparent 6%), radial-gradient(1000px 500px at 90% 80%, rgba(255,122,122,0.04), transparent 6%);transition:opacity .6s ease}
    .bg-wave{position:absolute;inset:0;animation: slowFloat 18s ease-in-out infinite;opacity:.9}
    .bg-orb{position:absolute;left:-10%;top:-20%;width:700px;height:700px;border-radius:50%;background: radial-gradient(circle at 30% 30%, rgba(96,165,250,0.06), rgba(96,165,250,0.02) 20%, transparent 40%);filter:blur(40px);transform:scale(.9);animation: floatOrb 22s linear infinite;}
    .bg-orb.b2{left:auto;right:-10%;top:10%;background: radial-gradient(circle at 70% 70%, rgba(255,122,122,0.05), rgba(255,210,107,0.02) 25%, transparent 50%);filter:blur(56px);animation: floatOrbRev 28s linear infinite;opacity:.9}
    @keyframes slowFloat{0%{transform:translateY(0)}50%{transform:translateY(14px)}100%{transform:translateY(0)}}
    @keyframes floatOrb{0%{transform:translateY(0) rotate(0)}100%{transform:translateY(-40px) rotate(360deg)}}
    @keyframes floatOrbRev{0%{transform:translateY(0) rotate(0)}100%{transform:translateY(40px) rotate(-360deg)}}

    header.site-header{display:flex;align-items:center;justify-content:space-between;gap:20px;margin-bottom:28px;backdrop-filter: blur(var(--glass-blur));padding:8px;border-radius:14px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:64px;height:64px;border-radius:14px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow: 0 6px 18px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);transform:translateZ(0);transition:transform .18s cubic-bezier(.2,.9,.2,1);flex-shrink:0}
    .logo:hover{transform:translateY(-6px) rotate(-6deg)}
    h1.site-title{font-size:18px;margin:0}
    p.site-sub{margin:0;color:var(--muted);font-size:13px}

    nav.actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .btn{position:relative;overflow:hidden;border:1px solid var(--glass-border);padding:10px 14px;border-radius:12px;color:inherit;cursor:pointer;font-weight:700;background:transparent;backdrop-filter: blur(4px);transition:transform .14s ease, box-shadow .12s ease}
    .btn:active{transform:translateY(1px) scale(.998)}
    .btn.primary{background: linear-gradient(90deg,var(--accent-start),var(--accent-end));color:#071427;border:0;box-shadow:0 12px 40px rgba(255,122,122,0.12);transform-origin:center}
    .btn .ripple{position:absolute;border-radius:50%;transform:scale(0);opacity:.6;pointer-events:none}

    .reserve-btn{position:relative;padding:10px 14px;border-radius:12px;font-weight:800;overflow:hidden;background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border: 1px solid rgba(255,255,255,0.06);transition: transform .16s cubic-bezier(.2,.9,.2,1), box-shadow .18s ease;box-shadow: 0 8px 30px rgba(2,6,23,0.45)}
    .reserve-btn::before{content: '';position: absolute;inset: 0;background: linear-gradient(90deg, var(--accent-start), var(--accent-end), var(--accent-blue-end), var(--accent-start));background-size: 220% 220%;border-radius: 12px;z-index: 0;opacity: 0;transform: scale(.98);transition: opacity .22s ease, transform .26s ease, filter .26s ease;filter: blur(8px);pointer-events: none;}
    .reserve-btn::after{content: '';position: absolute;left: -60%;top: -10%;width: 60%;height: 120%;background: linear-gradient(120deg, rgba(255,255,255,0.0) 0%, rgba(255,255,255,0.14) 48%, rgba(255,255,255,0.0) 100%);transform: skewX(-18deg) translateX(-100%);transition: transform .7s cubic-bezier(.2,.9,.2,1);z-index: 1;pointer-events: none;}
    .reserve-btn .label{position: relative;z-index: 2;display:inline-flex;align-items:center;gap:8px;color:#e6eef6;transition:color .18s ease,text-shadow .18s ease}
    .reserve-btn:hover{transform:translateY(-4px) scale(1.02);box-shadow: 0 22px 80px rgba(96,165,250,0.10)}
    .reserve-btn:hover::before{opacity:1;transform:scale(1)}
    .reserve-btn:hover::after{transform:skewX(-18deg) translateX(220%)}
    .reserve-btn:hover .label{color:#071427;text-shadow:0 6px 18px rgba(0,0,0,0.55), 0 0 12px rgba(96,165,250,0.06)}
    .reserve-btn:focus{outline:none;box-shadow:0 22px 60px rgba(96,165,250,0.10)}
    .reserve-btn .icon{display:inline-block;width:18px;height:18px;flex:0 0 18px;transform-origin:center;transition:transform .36s cubic-bezier(.2,.9,.2,1)}
    .reserve-btn:hover .icon{transform:translateY(-3px) rotate(-8deg) scale(1.06)}

    .burst-particle{position:absolute;width:8px;height:8px;border-radius:8px;pointer-events:none;opacity:0;transform:scale(.4);will-change:transform,opacity,left,top;background: radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,0.85));box-shadow:0 6px 18px rgba(0,0,0,0.4)}

    .hero{display:grid;grid-template-columns:1fr minmax(260px,420px);gap:30px;align-items:stretch;margin-bottom:34px}
    .hero-card{background:var(--card-grad);padding:32px;border-radius:22px;box-shadow:var(--shadow-strong);position:relative;overflow:visible}
    .hero-ink{position:absolute;right:28px;top:8px;width:200px;height:200px;border-radius:20px;filter:blur(18px);opacity:.12;background:linear-gradient(135deg,var(--accent-blue-start),var(--accent-blue-end));pointer-events:none}
    .hero h2{margin:0 0 8px 0;font-size:28px;letter-spacing:-0.3px}
    .hero p.lead{color:var(--muted);margin:0 0 18px}

    .quick-features{display:flex;gap:10px;flex-wrap:wrap}
    .feature{background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.006));padding:10px 12px;border-radius:12px;font-size:13px;color:var(--muted);backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.02)}

    .cta{display:flex;align-items:center;gap:18px;padding:18px;border-radius:14px;background:linear-gradient(90deg, rgba(7,20,39,0.4) 0%, rgba(96,165,250,0.02) 100%);margin-top:18px;box-shadow:0 10px 40px rgba(2,6,23,0.5)}
    .rate{font-weight:900;font-size:20px}

    .reveal{opacity:0;transform:translateY(8px) scale(.995)}
    .reveal.in{opacity:1;transform:none;transition:opacity .7s cubic-bezier(.2,.9,.3,1),transform .8s cubic-bezier(.2,.9,.3,1)}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:12px}
    @media (max-width:1100px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:760px){ .grid{grid-template-columns:repeat(1,1fr)} }

    .card{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:16px;box-shadow: 0 10px 40px rgba(2,6,23,0.6);transform-style:preserve-3d;transition:transform .28s cubic-bezier(.2,.9,.2,1), box-shadow .28s ease;will-change:transform;position:relative;overflow:hidden;cursor:default}
    .card::after{content:"";position:absolute;inset:0;border-radius:16px;background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent 30%);pointer-events:none;mix-blend-mode:overlay;opacity:.6}
    .teacher-header{display:flex;align-items:center;gap:12px;z-index:2;position:relative}
    .avatar{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;font-weight:700;backdrop-filter: blur(4px);flex-shrink:0}
    .teacher-meta{flex:1}
    .teacher-meta h3{margin:0;font-size:18px}
    .meta-sub{color:var(--muted);font-size:13px}
    .badge{display:inline-block;padding:6px 8px;border-radius:999px;font-size:12px;background:var(--glass);color:var(--muted);margin-left:6px}

    .subjects{display:flex;gap:6px;flex-wrap:wrap;margin-top:10px;z-index:2}
    .subject{background:var(--glass);padding:6px 8px;border-radius:10px;font-size:13px;color:var(--muted)}

    .card .shine{position:absolute;left:-30%;top:-60%;width:180%;height:180%;transform:rotate(25deg);pointer-events:none;mix-blend-mode:overlay;background:linear-gradient(90deg, rgba(255,255,255,0.00) 0%, rgba(255,255,255,0.03) 48%, rgba(255,255,255,0.00) 100%);opacity:0;transition:opacity .28s ease, transform .4s cubic-bezier(.2,.9,.2,1)}
    .card:hover{box-shadow: 0 30px 80px rgba(2,6,23,0.8);transform:translateY(-8px) rotateX(3deg)}
    .card:hover .shine{opacity:1;transform:translateX(6%) rotate(25deg)}

    .card-footer{display:flex;align-items:center;justify-content:space-between;margin-top:14px;z-index:2;position:relative}

    .card.reveal{opacity:0;transform:translateY(22px) scale(.995)}
    .card.reveal.in{opacity:1;transform:none;transition:opacity .8s cubic-bezier(.2,.9,.3,1),transform .9s cubic-bezier(.2,.9,.3,1)}

    /* modal: now column flex + body scroll area to keep actions visible above iPhone bar */
    .modal-backdrop{position:fixed;inset:0;display:none;align-items:flex-start;justify-content:center;padding:24px;z-index:60;touch-action: none}
    .modal-backdrop.show{display:flex}
    .backdrop-layer{position:absolute;inset:0;background:linear-gradient(90deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85));backdrop-filter: blur(6px);transition:opacity .28s ease;opacity:0}
    .modal{
      width:100%;
      max-width:860px;
      background:linear-gradient(180deg,#081226 0%, #061122 100%);
      border-radius:18px;
      border:1px solid rgba(255,255,255,0.03);
      box-shadow:var(--shadow-strong);
      box-sizing:border-box;
      margin:28px auto;
      /* reserve vertical space so modal doesn't go under iPhone bar */
      max-height: calc(100vh - 100px - env(safe-area-inset-bottom,0));
      display:flex;
      flex-direction:column;
      overflow:hidden;
      transform-origin:50% 10%;
      transform:translateY(18px) scale(.96);
      opacity:0;
      transition:transform .42s cubic-bezier(.2,.9,.2,1),opacity .36s ease;
      padding:18px 26px;
      touch-action: none;
    }
    .modal-backdrop.show .backdrop-layer{opacity:1}
    .modal-backdrop.show .modal{transform:translateY(0) scale(1);opacity:1}

    /* scrollable body inside modal */
    .modal-body{
      overflow:auto;
      -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
      overscroll-behavior: contain; /* contain overscroll to this element */
      touch-action: pan-y; /* allow vertical scrolling only */
      padding-bottom: calc(18px + env(safe-area-inset-bottom, 12px));
      flex: 1 1 auto;
      overflow-x: hidden; /* avoid horizontal movement */
    }

    .modal header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .modal #closeModal{font-size:18px;padding:8px 10px;border-radius:10px}

    /* make form-actions sticky inside modal-body so it's always visible above iPhone controls */
    .modal .form-actions{
      display:flex;gap:10px;justify-content:flex-end;margin-top:12px;flex-wrap:wrap;
      position:sticky;
      bottom: calc(12px + env(safe-area-inset-bottom, 12px));
      z-index: 30;
      background: linear-gradient(transparent, rgba(0,0,0,0));
      padding-top:6px;
    }

    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    /* ensure inputs have at least 16px font-size to prevent iOS auto-zoom on focus */
    input[type=text],input[type=email],input[type=tel],input[type=number],select,input[readonly],input:not([type]),textarea,button{
      font-size:16px;
    }
    input[type=text],input[type=email],input[type=tel],input[type=number],select,input[readonly],input:not([type]){width:100%;padding:14px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:inherit;font-size:14px;outline:none;box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 8px 28px rgba(2,6,23,0.45);transition: box-shadow .18s ease, border-color .12s ease, transform .06s ease}
    input:focus, select:focus{border-color: rgba(96,165,250,0.7);box-shadow: 0 18px 56px rgba(96,165,250,0.06), 0 6px 24px rgba(2,6,23,0.5);transform: translateY(-2px)}

    textarea{width:100%;min-height:180px;max-height:520px;padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:inherit;font-size:15px;line-height:1.6;outline:none;box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 14px 40px rgba(2,6,23,0.45);transition:box-shadow .18s ease,border-color .12s ease,transform .08s ease,height .08s ease;resize:vertical;overflow:auto;font-family:inherit}
    textarea:focus{border-color: rgba(96,165,250,0.75);box-shadow: 0 26px 80px rgba(96,165,250,0.08), inset 0 1px 0 rgba(255,255,255,0.02);transform: translateY(-3px) scale(1.01)}

    .outputs{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;margin-top:12px;font-size:14px}
    .outputs pre{background:transparent;border-radius:8px;padding:8px;margin:6px 0;color:inherit}

    footer{margin-top:36px;color:var(--muted);font-size:13px;text-align:center}

    @media (prefers-reduced-motion:reduce){.bg-orb, .bg-wave, .card, .modal, .hero-card, .card.reveal, .reveal { animation: none !important; transition: none !important; transform: none !important; }}

    /* small adjustments so elements scale nicely */
    @media (max-width:980px){
      .hero{grid-template-columns:1fr;gap:20px}
      .hero-card{padding:22px;border-radius:18px}
      header.site-header{gap:12px}
      .logo{width:56px;height:56px}
      .hero h2{font-size:22px}
      .cta{flex-direction:column;align-items:flex-start}
      .rate{font-size:18px}
      .avatar{width:56px;height:56px}
      .modal{max-height: calc(100vh - 80px - env(safe-area-inset-bottom,0));}
    }

    @media (max-width:760px){
      .container{padding:18px 14px}
      .logo{width:52px;height:52px}
      .site-title{font-size:16px}
      .site-sub{font-size:12px}
      .hero-card{padding:18px}
      .hero-ink{width:140px;height:140px;right:12px;top:6px;filter:blur(14px)}
      .btn{padding:9px 12px;font-size:14px}
      .avatar{width:52px;height:52px}
      .teacher-meta h3{font-size:16px}
      .card{padding:14px}
      .modal{padding:14px 18px}
      .modal-body{padding-bottom: calc(18px + env(safe-area-inset-bottom,12px))}
      input, select, textarea{font-size:14px;padding:12px}
      .quick-features{gap:8px}
    }

    @media (max-width:480px){
      :root{--container-pad:12px}
      .logo{width:48px;height:48px}
      .site-title{font-size:15px}
      .site-sub{font-size:12px}
      .btn{padding:9px 10px;font-size:13px}
      .hero h2{font-size:18px}
      .hero p.lead{font-size:13px}
      .avatar{width:48px;height:48px}
      .teacher-meta h3{font-size:15px}
      .grid{gap:12px}
      .card{padding:12px;border-radius:14px}
      .modal{border-radius:12px;padding:12px}
      .modal-body{padding-bottom: calc(12px + env(safe-area-inset-bottom,12px))}
      .cta{padding:12px}
      .rate{font-size:16px}
      .form-two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
      .form-two-col.stack-mobile{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="bg-anim" aria-hidden="true">
    <div class="bg-wave"></div>
    <div class="bg-orb"></div>
    <div class="bg-orb b2"></div>
  </div>

  <div class="container">
    <header class="site-header">
      <div class="brand">
        <div class="logo" aria-hidden="true" title="Logo cours particuliers">
          <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <rect x="2" y="6" width="44" height="36" rx="8" fill="url(#g)" />
            <path d="M10 28c4-4 10-6 14-6s10 2 14 6" stroke="#fff" stroke-opacity="0.85" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            <defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1"><stop offset="0" stop-color="#1e293b"/><stop offset="1" stop-color="#0b1220"/></linearGradient></defs>
          </svg>
        </div>
        <div>
          <h1 class="site-title" data-i18n="siteTitle">Cours particuliers — Section internationale</h1>
          <p class="site-sub" data-i18n="siteSub">Explications en japonais • Professeurs natifs et bilingues</p>
        </div>
      </div>

      <nav class="actions" aria-label="Actions">
        <button class="btn ghost" id="langToggle" aria-pressed="false" title="Basculer la langue">FR / JP</button>
        <button class="btn primary reserve-btn" id="openForm" data-i18n="takeCourse"><span class="label">Prendre des cours</span></button>
      </nav>
    </header>

    <main>
      <section class="hero">
        <div class="hero-card reveal" id="heroCard">
          <div class="hero-ink" aria-hidden="true"></div>
          <h2 data-i18n="heroTitle">Des cours clairs, en japonais — pour réussir en section internationale</h2>
          <p class="lead" data-i18n="heroLead">Séances individuelles adaptées : japonais, français, anglais, mathématiques et méthodologie. Sessions uniquement à domicile.</p>

          <div class="quick-features" role="list">
            <span class="feature" role="listitem" data-i18n="feature1">Professeurs natifs</span>
            <span class="feature" role="listitem" data-i18n="feature2">Tarifs transparents</span>
            <span class="feature" role="listitem" data-i18n="feature3">Suivi personnalisé</span>
            <span class="feature" role="listitem" data-i18n="feature4">Essai gratuit</span>
          </div>

          <div class="cta" role="region" aria-label="Offre">
            <div>
              <div class="muted" data-i18n="fromLabel">À partir de</div>
              <div class="rate">20 €/h <span class="muted" style="font-weight:600;font-size:13px" data-i18n="perSession">(séance 1h)</span></div>
            </div>
            <div style="flex:1">
              <p class="muted" style="margin:0" data-i18n="ctaText">Réservez une séance d'essai — suivi pédagogique inclus.</p>
            </div>
            <div>
              <button class="btn primary reserve-btn" id="openForm2" data-i18n="ctaReserve"><span class="label">Réserver maintenant</span></button>
            </div>
          </div>

          <p class="muted" style="margin-top:14px;font-size:13px" data-i18n="profList">Nos professeurs : Akaru, Tokuma, Leo. <strong>Tarif unique : 20 €/h</strong></p>
        </div>

        <aside class="hero-card reveal" aria-labelledby="contact-quick">
          <h3 id="contact-quick" data-i18n="contactQuick">Contact rapide</h3>
          <p class="muted" data-i18n="contactLead">Demande rapide — réponse sous 24 h.</p>

          <div style="margin-top:12px;display:grid;gap:8px">
            <div><strong data-i18n="telLabel">Tél :</strong> <span class="muted">+33 6 00 00 00 00</span></div>
            <div><strong data-i18n="emailLabel">Email :</strong> <span class="muted">nihon_connect.paris@outlook.com</span></div>
            <div><strong data-i18n="zonesLabel">Zones :</strong> <span class="muted">Courbevoie, Bois-Colombes, Paris Ouest</span></div>
          </div>
        </aside>
      </section>

      <section aria-labelledby="teachers" style="margin-top:6px">
        <h2 id="teachers" style="margin-bottom:12px" data-i18n="teachersTitle">Nos professeurs</h2>

        <div class="grid" id="teachersGrid">
          <!-- Teacher cards unchanged -->
          <article class="card reveal" data-name="Akaru" data-rate="20" tabindex="0">
            <div class="shine"></div>
            <div class="teacher-header">
              <div class="avatar" aria-hidden="true">A</div>
              <div class="teacher-meta">
                <h3>Akaru <span class="badge">16 ans</span></h3>
                <div class="meta-sub" data-i18n="courbevoie">Courbevoie</div>
              </div>
              <div style="text-align:right">
                <div class="rate">20 €/h</div>
                <div class="muted" style="font-size:13px" data-i18n="availabilityAkaru">Après l'école, week-end</div>
              </div>
            </div>

            <div class="subjects" aria-hidden>
                <span class="subject">Japonais</span>
              <span class="subject">Mathématiques</span>
              <span class="subject">Anglais</span>
            </div>

            <p class="muted" style="margin-top:10px" data-i18n="descAkaru">Élève en section internationale — méthode adaptée et claire.</p>

            <div class="card-footer">
              <div class="muted" style="font-size:13px">Diplôme: DNBI</div>
              <div>
                <button class="btn reserve-btn" data-action="book" data-prof="Akaru" data-i18n="reserve"><span class="label">Réserver</span></button>
              </div>
            </div>
          </article>

          <article class="card reveal" data-name="Tokuma" data-rate="20" tabindex="0">
            <div class="shine"></div>
            <div class="teacher-header">
              <div class="avatar" aria-hidden="true">T</div>
              <div class="teacher-meta">
                <h3>Tokuma <span class="badge">15 ans</span></h3>
                <div class="meta-sub">Bois-Colombes</div>
              </div>
              <div style="text-align:right">
                <div class="rate">20 €/h</div>
                <div class="muted" style="font-size:13px" data-i18n="availabilityTokuma">Soirées, week-end</div>
              </div>
            </div>

            <div class="subjects">
                <span class="subject">Japonais</span>
                <span class="subject">Mathématiques</span>
                <span class="subject">Français</span>
                <span class="subject">Anglais</span>
            </div>

            <p class="muted" style="margin-top:10px" data-i18n="descTokuma">Approche structurée — excellent résultats.</p>

            <div class="card-footer">
              <div class="muted" style="font-size:13px">Diplôme: DNBI</div>
              <div>
                <button class="btn reserve-btn" data-action="book" data-prof="Tokuma" data-i18n="reserve"><span class="label">Réserver</span></button>
              </div>
            </div>
          </article>

          <article class="card reveal" data-name="Leo" data-rate="20" tabindex="0">
            <div class="shine"></div>
            <div class="teacher-header">
              <div class="avatar" aria-hidden="true">L</div>
              <div class="teacher-meta">
                <h3>Leo <span class="badge">15 ans</span></h3>
                <div class="meta-sub">Courbevoie</div>
              </div>
              <div style="text-align:right">
                <div class="rate">20 €/h</div>
                <div class="muted" style="font-size:13px" data-i18n="availabilityLeo">Vendredi soir, week-end</div>
              </div>
            </div>

            <div class="subjects">
              <span class="subject">Japonais</span>
              <span class="subject">Mathématiques</span>
            </div>

            <p class="muted" style="margin-top:10px" data-i18n="descLeo">Bonne maîtrise du japonais. Approche pédagogique.</p>

            <div class="card-footer">
              <div class="muted" style="font-size:13px">Diplôme: DNBI, JLPT N2</div>
              <div>
                <button class="btn reserve-btn" data-action="book" data-prof="Leo" data-i18n="reserve"><span class="label">Réserver</span></button>
              </div>
            </div>
          </article>

        </div>
      </section>

      <!-- Modal -->
      <div class="modal-backdrop" id="modal" role="dialog" aria-hidden="true" aria-labelledby="modalTitle">
        <div class="backdrop-layer" aria-hidden="true"></div>
        <div class="modal" role="document" aria-modal="true">
          <header>
            <div>
              <h2 id="modalTitle" data-i18n="modalTitle">Prendre un cours — demande</h2>
              <p class="muted" style="margin:4px 0 0 0" data-i18n="modalLead">Remplissez ce formulaire — nous générons le mail de réservation.</p>
            </div>
            <div>
              <button class="btn" id="closeModal" aria-label="Fermer">✕</button>
            </div>
          </header>

          <!-- modal-body is scrollable; form-actions inside form are sticky to bottom of this area -->
          <div class="modal-body">
            <form id="bookingForm" novalidate>
              <fieldset style="border:0;padding:0;margin-top:12px">
                <legend class="muted" data-i18n="fieldsetLegend">Informations de réservation</legend>

                <!-- use helper class for responsive columns -->
                <div class="form-two-col" style="margin-top:8px;display:grid;grid-template-columns:1fr 1fr;gap:12px">
                  <div>
                    <label for="profSelect" data-i18n="labelChooseProf">Choisir un professeur *</label>
                    <select id="profSelect" required>
                      <option value="" selected disabled data-i18n-option="optChoose">-- Choisir --</option>
                      <option value="Akaru">Akaru — 20 €/h</option>
                      <option value="Tokuma">Tokuma — 20 €/h</option>
                      <option value="Leo">Leo — 20 €/h</option>
                    </select>
                  </div>

                  <div>
                    <label for="timeSelect" data-i18n="labelTime">Créneau souhaité *</label>
                    <select id="timeSelect" required>
                      <option value="" selected disabled data-i18n-option="optChooseProfFirst">Choisir un professeur d'abord</option>
                    </select>
                  </div>

                  <div>
                    <label for="rateDisplay" data-i18n="labelRate">Tarif horaire</label>
                    <input id="rateDisplay" readonly aria-readonly="true" value="—" required>
                  </div>

                  <div>
                    <label for="duration" data-i18n="labelDuration">Durée (heures)</label>
                    <select id="duration" aria-label="Durée" required>
                      <option value="1">1 h</option>
                      <option value="1.5">1 h 30</option>
                      <option value="2">2 h</option>
                    </select>
                  </div>
                </div>

                <hr style="margin:14px 0;border:0;border-top:1px solid rgba(255,255,255,0.03)">

                <div class="form-two-col" style="gap:12px;display:grid;grid-template-columns:1fr 1fr">
                  <div>
                    <label for="childLast" data-i18n="labelChildLast">Nom de famille (enfant) *</label>
                    <input id="childLast" required>
                  </div>
                  <div>
                    <label for="childFirst" data-i18n="labelChildFirst">Prénom (enfant) *</label>
                    <input id="childFirst" required>
                  </div>

                  <div>
                    <label for="childAge" data-i18n="labelAge">Âge *</label>
                    <input id="childAge" type="number" min="3" max="18" required>
                  </div>
                  <div>
                    <label for="childClass" data-i18n="labelClass">Classe (ex : CM2) *</label>
                    <input id="childClass" required>
                  </div>

                  <div>
                    <label for="repLast" data-i18n="labelRepLast">Nom du représentant *</label>
                    <input id="repLast" required>
                  </div>
                  <div>
                    <label for="repFirst" data-i18n="labelRepFirst">Prénom du représentant *</label>
                    <input id="repFirst" required>
                  </div>

                  <div>
                    <label for="email" data-i18n="labelEmail">E-mail *</label>
                    <input id="email" type="email" required>
                  </div>
                  <div>
                    <label for="phone" data-i18n="labelPhone">Téléphone *</label>
                    <input id="phone" type="tel" inputmode="tel" placeholder="06XXXXXXXX" required>
                  </div>

                  <!-- Adresse + postal (ajoutés) -->
                  <div>
                    <label for="address" data-i18n="labelAddress">Adresse du domicile *</label>
                    <input id="address" data-i18n-placeholder="placeholderAddress" placeholder="Ex : 12 avenue des Champs-Élysées, 75008 Paris" required>
                  </div>
                  <div>
                    <label for="postal" data-i18n="labelPostal">Code postal *</label>
                    <input id="postal" data-i18n-placeholder="placeholderPostal" placeholder="75000" required>
                  </div>

                  <div style="grid-column:1 / -1">
                    <label for="extra" data-i18n="labelExtra">Message — informations complémentaires (optionnel)</label>
                    <textarea id="extra" data-i18n-placeholder="placeholderExtra" placeholder="Ex : objectifs, difficultés, matériel disponible..."></textarea>
                  </div>
                </div>

                <div class="form-actions">
                  <button type="button" class="btn" id="resetForm" data-i18n="reset">Réinitialiser</button>
                  <button type="submit" class="btn primary" data-i18n="generateMail">Générer le mail</button>
                </div>

                <div id="outputs" class="outputs" hidden aria-live="polite"></div>
              </fieldset>
            </form>
          </div>
        </div>
      </div>

    </main>

    <footer>
      <div style="padding-bottom: 30px;" class="muted">© 2025 — Cours particuliers — Section internationale • Design premium</div>
    </footer>
  </div>

  <script>
    // ===== data + rates + availability =====
    const availability = {
      'Akaru': ['Lundi 16:00-17:00','Mercredi 15:00-16:00','Samedi 10:00-11:00'],
      'Tokuma': ['Lundi 17:00','Mercredi 17:00','Vendredi 18:00','Samedi 17:00'],
      'Leo': ['Vendredi 19:30','Samedi 9:00','Samedi 18:00','Dimanche 09:00']
    };
    const rates = { 'Akaru':20, 'Tokuma':20, 'Leo':20 };
    const MAIL_ADDRESS = 'nihon_connect.paris@outlook.com';

    // ===== elements =====
    const langToggle = document.getElementById('langToggle');
    const openForm = document.getElementById('openForm');
    const openForm2 = document.getElementById('openForm2');
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const profSelect = document.getElementById('profSelect');
    const timeSelect = document.getElementById('timeSelect');
    const rateDisplay = document.getElementById('rateDisplay');
    const bookingForm = document.getElementById('bookingForm');
    const outputs = document.getElementById('outputs');
    const resetForm = document.getElementById('resetForm');

    // ===== translations =====
    const translations = {
      fr: {
        langNameToggle: '日本語',
        siteTitle: 'Cours particuliers — Section internationale',
        siteSub: 'Explications en japonais • Professeurs natifs et bilingues',
        heroTitle: 'Des cours clairs, en japonais — pour réussir en section internationale',
        heroLead: 'Séances individuelles adaptées : japonais, français, anglais, mathématiques et méthodologie. Sessions à domicile.',
        feature1: 'Professeurs natifs',
        feature2: 'Tarifs transparents',
        feature3: 'Suivi personnalisé',
        feature4: 'Essai gratuit',
        fromLabel: 'À partir de',
        perSession: '(séance 1h)',
        ctaText: 'Réservez une séance d\'essai 100% gratuite!',
        ctaReserve: 'Réserver maintenant',
        profList: 'Nos professeurs : Akaru, Tokuma, Leo. <strong>Tarif unique : 20 €/h  — uniquement en espece</strong>',
        contactQuick: 'Contact rapide',
        contactLead: 'Demande rapide — réponse sous 24 h.',
        telLabel: 'Tél :',
        emailLabel: 'Email :',
        zonesLabel: 'Zones :',
        teachersTitle: 'Nos professeurs',
        courbevoie: 'Courbevoie',
        availabilityAkaru: "Après l'école, week-end",
        availabilityTokuma: 'Soirées, week-end',
        availabilityLeo: 'Vendredi soir, week-end',
        descAkaru: 'Élève en section internationale — méthode adaptée et claire.',
        descTokuma: 'Approche structurée — excellent résultats.',
        descLeo: 'Bonne maîtrise du japonais. Approche pédagogique.',
        reserve: 'Réserver',
        takeCourse: 'Prendre des cours',
        modalTitle: 'Prendre un cours — demande',
        modalLead: 'Remplissez ce formulaire — nous générons le mail de réservation.',
        fieldsetLegend: 'Informations de réservation',
        labelChooseProf: 'Choisir un professeur *',
        labelTime: 'Créneau souhaité *',
        optChoose: '-- Choisir --',
        optChooseProfFirst: 'Choisir un professeur d\'abord',
        labelRate: 'Tarif horaire',
        labelDuration: 'Durée (heures)',
        labelChildLast: 'Nom de famille (enfant) *',
        labelChildFirst: 'Prénom (enfant) *',
        labelAge: 'Âge *',
        labelClass: 'Classe (ex : CM2) *',
        labelRepLast: 'Nom du représentant *',
        labelRepFirst: 'Prénom du représentant *',
        labelEmail: 'E-mail *',
        labelPhone: 'Téléphone *',
        labelAddress: 'Adresse du domicile *',
        placeholderAddress: 'Ex : 12 avenue des Champs-Élysées, 75008 Paris',
        labelPostal: 'Code postal *',
        placeholderPostal: '75000',
        labelExtra: 'Message — informations complémentaires (optionnel)',
        placeholderExtra: 'Ex : objectifs, difficultés, matériel disponible...',
        reset: 'Réinitialiser',
        generateMail: 'Générer le mail'
      },
      jp: {
        langNameToggle: 'Français',
        siteTitle: '個別指導 — インターナショナルセクション',
        siteSub: '日本語での指導 • ネイティブとバイリンガル講師',
        heroTitle: '日本語でわかりやすく — インターナショナルセクションで成功するために',
        heroLead: '日本語、フランス語、英語、数学、学習法に対応した個別セッション。出張で提供します。',
        feature1: 'ネイティブ講師',
        feature2: '料金は明瞭',
        feature3: '個別フォロー',
        feature4: '初回無料',
        fromLabel: '料金',
        perSession: '（1時間）',
        ctaText: '初回無料 — 安心して始める0円体験。',
        ctaReserve: '今すぐ予約',
        profList: '講師：Akaru、Tokuma、Leo。<strong>料金：20 €/h — 現金のみ</strong>',
        contactQuick: 'お問い合わせ',
        contactLead: 'お問い合わせは通常24時間以内に返信します。',
        telLabel: '電話：',
        emailLabel: 'メール：',
        zonesLabel: '対応地域：',
        teachersTitle: '講師紹介',
        courbevoie: 'Courbevoie',
        availabilityAkaru: '放課後、週末',
        availabilityTokuma: '夜間、週末',
        availabilityLeo: '金曜夜、週末',
        descAkaru: 'インターナショナルセクション在籍 — 体系的でわかりやすい指導。',
        descTokuma: '構造化されたアプローチ — 優れた成果。',
        descLeo: '日本語に堪能。親しみやすく教育的な指導。',
        reserve: '予約する',
        takeCourse: 'レッスンを予約',
        modalTitle: 'レッスン予約 — 申込',
        modalLead: 'フォームにご記入ください — 予約メールを生成します。',
        fieldsetLegend: '予約情報',
        labelChooseProf: '講師を選択 *',
        labelTime: '希望時間 *',
        optChoose: '-- 選択 --',
        optChooseProfFirst: '先に講師を選んでください',
        labelRate: '時給',
        labelDuration: '時間（時間）',
        labelChildLast: 'お子様の姓 *',
        labelChildFirst: 'お子様の名 *',
        labelAge: '年齢 *',
        labelClass: '学年（例：CM2） *',
        labelRepLast: '保護者の姓 *',
        labelRepFirst: '保護者の名 *',
        labelEmail: 'Eメール *',
        labelPhone: '電話番号 *',
        labelAddress: '自宅住所 *',
        placeholderAddress: '例：東京都渋谷区1-2-3',
        labelPostal: '郵便番号 *',
        placeholderPostal: '150-0000',
        labelExtra: 'メッセージ — 補足情報（任意）',
        placeholderExtra: '例：目標、困っている点、利用可能な教材...',
        reset: 'リセット',
        generateMail: 'メールを生成'
      }
    };

    // current language (default FR)
    let currentLang = 'fr';

    // utility: check if element is inside outputs -> skip translation
    function isInsideOutputs(el){
      return el && (el.id === 'outputs' || el.closest && el.closest('#outputs'));
    }

    // translate page (excluding #outputs)
    function translatePage(lang){
      const map = translations[lang] || translations.fr;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        if(isInsideOutputs(el)) return;
        const key = el.getAttribute('data-i18n');
        if(!key) return;
        const txt = map[key];
        if(txt === undefined) return;
        if(key === 'profList') el.innerHTML = txt;
        else el.textContent = txt;
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{
        if(isInsideOutputs(el)) return;
        const key = el.getAttribute('data-i18n-placeholder');
        const txt = map[key];
        if(txt !== undefined) el.placeholder = txt;
      });
      document.querySelectorAll('[data-i18n-option]').forEach(opt=>{
        if(isInsideOutputs(opt)) return;
        const key = opt.getAttribute('data-i18n-option');
        const txt = map[key];
        if(txt !== undefined) opt.textContent = txt;
      });
      langToggle.textContent = map.langNameToggle || (lang === 'fr' ? '日本語' : 'Français');
      langToggle.setAttribute('aria-pressed', lang === 'jp' ? 'true' : 'false');
    }

    // attach ripples to buttons
    function attachRipples(){
      document.querySelectorAll('.btn').forEach(btn=>{
        if(btn.__rippleAttached) return;
        btn.__rippleAttached = true;
        btn.addEventListener('pointerdown', function(e){
          const rect = btn.getBoundingClientRect();
          const ripple = document.createElement('span');
          ripple.className = 'ripple';
          const size = Math.max(rect.width, rect.height) * 1.4;
          ripple.style.width = ripple.style.height = size + 'px';
          ripple.style.left = (e.clientX - rect.left - size/2) + 'px';
          ripple.style.top = (e.clientY - rect.top - size/2) + 'px';
          ripple.style.position = 'absolute';
          ripple.style.background = 'rgba(255,255,255,0.08)';
          ripple.style.transform = 'scale(0)';
          ripple.style.transition = 'transform .55s cubic-bezier(.2,.9,.2,1), opacity .9s ease';
          btn.appendChild(ripple);
          requestAnimationFrame(()=> ripple.style.transform = 'scale(1.8)');
          setTimeout(()=> { ripple.style.opacity = '0'; setTimeout(()=> ripple.remove(), 900); }, 350);
        });
      });
    }
    attachRipples();

    // particle burst
    function burstParticles(target, colorPalette = ['#fff','#ffd36b','#6ee7b7','#60a5fa']){
      const rect = target.getBoundingClientRect();
      const parent = document.body;
      const count = Math.floor(8 + Math.random()*8);
      for(let i=0;i<count;i++){
        const p = document.createElement('div');
        p.className = 'burst-particle';
        const size = (6 + Math.random()*8);
        p.style.width = p.style.height = size + 'px';
        p.style.left = (rect.left + rect.width/2 - size/2) + 'px';
        p.style.top = (rect.top + rect.height/2 - size/2) + 'px';
        const c = colorPalette[Math.floor(Math.random()*colorPalette.length)];
        p.style.background = c;
        p.style.opacity = '0.95';
        parent.appendChild(p);

        const angle = Math.random() * Math.PI * 2;
        const distance = 40 + Math.random()*80;
        const dx = Math.cos(angle) * distance;
        const dy = Math.sin(angle) * distance;
        const rotate = (Math.random()*360);
        const duration = 560 + Math.random()*360;
        const start = performance.now();
        requestAnimationFrame(function anim(t){
          const elapsed = t - start;
          const progress = Math.min(1, elapsed / duration);
          const eased = 1 - Math.pow(1 - progress, 3);
          p.style.transform = `translate(${dx*eased}px, ${dy*eased}px) rotate(${rotate*eased}deg) scale(${1 - 0.7*eased})`;
          p.style.opacity = String(1 - eased);
          if(progress < 1) requestAnimationFrame(anim);
          else p.remove();
        });
      }
    }

    // modal open/close
    function openModal(prefill){
      modal.classList.add('show');
      modal.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      // disable background touchmove while modal open (but allow inside modal-body)
      enableModalTouchLock();
      if(prefill){
        profSelect.value = prefill;
        setTimeout(()=> profSelect.dispatchEvent(new Event('change')),40);
      }
      setTimeout(()=> profSelect.focus(), 140);
    }
    function closeModalFn(){
      modal.classList.remove('show');
      modal.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
      bookingForm.reset();
      timeSelect.innerHTML = '<option value="" selected disabled data-i18n-option="optChooseProfFirst">Choisir un professeur d\'abord</option>';
      rateDisplay.value = '—';
      outputs.hidden = true; outputs.innerHTML = '';
      const t = document.getElementById('extra'); if(t) t.style.height = '';
      translatePage(currentLang);
      disableModalTouchLock();
    }

    // populate times when professor changes
    profSelect.addEventListener('change', (e)=>{
      const prof = e.target.value;
      timeSelect.innerHTML = '';
      if(availability[prof]){
        const placeholder = document.createElement('option'); placeholder.disabled = true; placeholder.selected = true;
        placeholder.setAttribute('data-i18n-option', 'optChoose');
        placeholder.textContent = translations[currentLang].optChoose || '-- Choisir --';
        timeSelect.appendChild(placeholder);
        availability[prof].forEach(slot=>{
          const opt = document.createElement('option'); opt.value = slot; opt.textContent = slot; timeSelect.appendChild(opt);
        });
      } else {
        const opt = document.createElement('option'); opt.disabled=true; opt.selected=true; opt.textContent = (currentLang === 'jp' ? '利用可能な時間がありません' : 'Pas de créneaux disponibles'); timeSelect.appendChild(opt);
      }
      rateDisplay.value = rates[prof] ? rates[prof] + ' €/h' : '—';
    });

    // reset
    resetForm.addEventListener('click', ()=>{
      bookingForm.reset();
      timeSelect.innerHTML = '<option value="" selected disabled data-i18n-option="optChooseProfFirst">Choisir un professeur d\'abord</option>';
      rateDisplay.value='—';
      outputs.hidden=true; outputs.innerHTML='';
      const t = document.getElementById('extra'); if(t) t.style.height = '';
      translatePage(currentLang);
    });

    // submit -> build mail (mail always in FRENCH)
    bookingForm.addEventListener('submit',(e)=>{
      e.preventDefault();
      const prof = profSelect.value;
      const time = timeSelect.value;
      const duration = Number(document.getElementById('duration').value);
      const childLast = document.getElementById('childLast').value.trim();
      const childFirst = document.getElementById('childFirst').value.trim();
      const childAge = document.getElementById('childAge').value.trim();
      const childClass = document.getElementById('childClass').value.trim();
      const repLast = document.getElementById('repLast').value.trim();
      const repFirst = document.getElementById('repFirst').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value.trim();
      const postal = document.getElementById('postal').value.trim();
      const extra = document.getElementById('extra').value.trim();

      if(!prof || !time || !childLast || !childFirst || !childAge || !childClass || !repLast || !repFirst || !email || !phone || !address || !postal){
        alert(currentLang === 'jp' ? '必須項目をすべて入力してください。' : 'Veuillez remplir tous les champs obligatoires.');
        return;
      }

      const hourlyRate = rates[prof] || 0;
      const total = (hourlyRate * duration).toFixed(2);
      const subject = `Demande de cours: ${prof} — ${childLast} ${childFirst}`;

      const lines = [];
      lines.push(`Professeur choisi: ${prof}`);
      lines.push(`Créneau souhaité: ${time}`);
      lines.push(`Durée: ${duration} h`);
      lines.push(`Nom et prénom (enfant): ${childLast} ${childFirst}`);
      lines.push(`Âge (enfant): ${childAge}`);
      lines.push(`Classe: ${childClass}`);
      lines.push(`Nom et prénom (représentant): ${repLast} ${repFirst}`);
      lines.push(`E-mail: ${email}`);
      lines.push(`Téléphone: ${phone}`);
      lines.push(`Adresse du domicile: ${address}`);
      lines.push(`Code postal: ${postal}`);
      lines.push(`Tarif horaire: ${hourlyRate} €/h`);
      lines.push(`Prix total (estimé): ${total} €`);
      if(extra) { lines.push(''); lines.push('Infos complémentaires:'); lines.push(extra); }

      const body = lines.join('\n');

      // Build outputs with separate copy buttons
      outputs.hidden = false;
      outputs.innerHTML = `
        <div><strong>Adresse mail:</strong> <span id="outEmail" class="muted">${MAIL_ADDRESS}</span>
          <button class="btn" id="copyEmailBtn" style="margin-left:8px">Copier l'adresse</button>
        </div>
        <div style="margin-top:6px"><strong>Sujet:</strong> <span id="outSubject">${escapeHtml(subject)}</span>
          <button class="btn" id="copySubjectBtn" style="margin-left:8px">Copier le sujet</button>
        </div>
        <div style="margin-top:8px">
          <strong>Contenu du mail :</strong>
          <button class="btn" id="copyBodyBtn" style="margin-left:8px">Copier le contenu</button>
        </div>
        <pre id="outBody" style="white-space:pre-wrap;margin-top:8px">${escapeHtml(body)}</pre>
        <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn" id="copyAllBtn">Copier tout (sujet + contenu)</button>
          <button class="btn primary" id="sendMailBtn">${currentLang === 'jp' ? 'メールクライアントで開く' : 'Ouvrir dans le client mail'}</button>
        </div>
      `;

      // Add listeners for the copy buttons (separate)
      const copyToClipboard = (text, cbMsg) => {
        if(navigator.clipboard){
          navigator.clipboard.writeText(text).then(()=>{ alert(cbMsg); }).catch(()=>{ fallbackCopy(text, cbMsg); });
        } else {
          fallbackCopy(text, cbMsg);
        }
      };
      const fallbackCopy = (text, cbMsg) => {
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.style.position = 'fixed';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        try{ document.execCommand('copy'); alert(cbMsg); }catch(e){ alert(cbMsg); }
        ta.remove();
      };

      document.getElementById('copyEmailBtn').addEventListener('click', ()=>{
        const text = MAIL_ADDRESS;
        copyToClipboard(text, currentLang === 'jp' ? 'メールアドレスをコピーしました' : 'Adresse copiée');
      });
      document.getElementById('copySubjectBtn').addEventListener('click', ()=>{
        const text = subject;
        copyToClipboard(text, currentLang === 'jp' ? '件名をコピーしました' : 'Sujet copié');
      });
      document.getElementById('copyBodyBtn').addEventListener('click', ()=>{
        const text = body;
        copyToClipboard(text, currentLang === 'jp' ? 'メール本文をコピーしました' : 'Contenu copié');
      });
      document.getElementById('copyAllBtn').addEventListener('click', ()=>{
        const text = `${subject}\n\n${body}`;
        copyToClipboard(text, currentLang === 'jp' ? '件名と本文をコピーしました' : 'Sujet et contenu copiés');
      });

      document.getElementById('sendMailBtn').addEventListener('click', ()=>{
        const mailto = `mailto:${encodeURIComponent(MAIL_ADDRESS)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        window.location.href = mailto;
      });

      try{ localStorage.setItem('last_prof', prof); }catch(e){}
      outputs.scrollIntoView({behavior:'smooth'});
    });

    function escapeHtml(str){ return String(str).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

    // restore last selection visual pill
    try{
      const last = localStorage.getItem('last_prof');
      if(last){ document.querySelectorAll('[data-action="book"]').forEach(b=>{ if(b.getAttribute('data-prof')===last) b.classList.add('pill'); }) }
    }catch(e){}

    // close modal on Escape
    document.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && modal.classList.contains('show')) closeModalFn(); });

    // small fallback: select focus class behavior
    document.querySelectorAll('select').forEach(s => {
      s.addEventListener('focus', () => s.classList.add('custom-arrow'));
      s.addEventListener('blur', () => s.classList.remove('custom-arrow'));
    });

    // auto-resize textarea
    (function(){
      const ta = document.getElementById('extra');
      if(!ta) return;
      const MAX_H = 520;
      function autosize(el){
        el.style.height = 'auto';
        const next = Math.min(el.scrollHeight, MAX_H);
        el.style.height = next + 'px';
      }
      autosize(ta);
      ta.addEventListener('input', (e)=> autosize(e.target));
      ta.addEventListener('focus', ()=> autosize(ta));
    })();

    // 3D tilt for cards
    (function(){
      const cards = document.querySelectorAll('.card');
      const supportsDeviceOrientation = 'ondeviceorientation' in window;
      cards.forEach(card=>{
        const rect = () => card.getBoundingClientRect();
        let bound = rect();
        function onMove(e){
          const x = (e.clientX ?? (e.touches && e.touches[0].clientX)) - bound.left;
          const y = (e.clientY ?? (e.touches && e.touches[0].clientY)) - bound.top;
          const cx = bound.width/2; const cy = bound.height/2;
          const px = (x - cx)/cx; const py = (y - cy)/cy;
          const tiltX = (py * 7).toFixed(2);
          const tiltY = (px * -10).toFixed(2);
          card.style.transform = `perspective(900px) rotateX(${tiltX}deg) rotateY(${tiltY}deg) translateZ(6px)`;
          const shine = card.querySelector('.shine');
          if(shine){ const mx = (px * 50) + 50; shine.style.transform = `translateX(${mx*0.6}%) rotate(25deg)`; }
        }
        function onEnter(){ bound = rect(); card.style.transition = 'transform .12s cubic-bezier(.2,.9,.2,1), box-shadow .12s ease'; }
        function onLeave(){ card.style.transition = 'transform .6s cubic-bezier(.2,.9,.2,1), box-shadow .6s ease'; card.style.transform = ''; const shine = card.querySelector('.shine'); if(shine) shine.style.transform = ''; }
        card.addEventListener('pointermove', onMove);
        card.addEventListener('pointerenter', onEnter);
        card.addEventListener('pointerleave', onLeave);
      });
      if (supportsDeviceOrientation){
        window.addEventListener('deviceorientation', (ev) => {
          const x = ev.gamma || 0; const y = ev.beta || 0;
          document.querySelector('.bg-anim').style.transform = `translate3d(${x*0.3}px, ${y*0.3}px, 0)`;
        }, {passive:true});
      }
    })();

    // reveal on scroll
    (function(){
      const io = new IntersectionObserver((entries, obs)=>{
        entries.forEach(entry=>{
          if(entry.isIntersecting){ entry.target.classList.add('in'); entry.target.classList.remove('reveal'); obs.unobserve(entry.target); }
        });
      }, {threshold:0.12});
      document.querySelectorAll('.reveal').forEach((el, i)=>{ el.style.transitionDelay = (i*80)+'ms'; io.observe(el); });
    })();

    // attach ripples for dynamic outputs
    const mutObserver = new MutationObserver((mutations)=>{
      mutations.forEach(m=>{
        m.addedNodes && m.addedNodes.forEach(node=>{
          if(node.nodeType===1 && node.querySelectorAll) attachRipples();
        });
      });
    });
    mutObserver.observe(document.body, {childList:true, subtree:true});

    // Language toggle
    langToggle.addEventListener('click', ()=>{
      currentLang = currentLang === 'fr' ? 'jp' : 'fr';
      translatePage(currentLang);
    });

    // initialize UI language
    translatePage(currentLang);

    // reservation buttons: burstParticles + open modal
    document.querySelectorAll('[data-action="book"]').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const prof = e.currentTarget.getAttribute('data-prof');
        burstParticles(e.currentTarget);
        setTimeout(()=> openModal(prof), 160);
      });
    });
    // header/cta reserve buttons
    if(openForm) openForm.addEventListener('click', ()=>{ burstParticles(openForm); setTimeout(()=> openModal(), 140); });
    if(openForm2) openForm2.addEventListener('click', ()=>{ burstParticles(openForm2); setTimeout(()=> openModal(), 140); });

    // close modal
    if(closeModal) closeModal.addEventListener('click', closeModalFn);
    modal.addEventListener('click', (e)=> { if(e.target === modal) closeModalFn(); });

    // ---------- Touch locking: prevent body scroll while allowing modal-body scroll ----------
    // We add a touchmove listener that prevents default outside modal-body.
    let _touchLockHandler = null;
    function enableModalTouchLock(){
      // ensure we only add once
      if(_touchLockHandler) return;
      _touchLockHandler = function(e){
        // if modal not shown: allow default
        if(!modal.classList.contains('show')) return;
        // if the touch is inside modal-body, allow it (do nothing)
        const target = e.target;
        if(target && (target.closest && target.closest('.modal-body'))) {
          // allow scrolling inside modal-body
          return;
        }
        // otherwise prevent default and stop page from moving
        e.preventDefault();
      };
      document.addEventListener('touchmove', _touchLockHandler, {passive:false});
      // also block wheel to prevent desktop wheel scrolling of background when modal open
      document.addEventListener('wheel', wheelBlock, {passive:false});
    }
    function disableModalTouchLock(){
      if(!_touchLockHandler) return;
      document.removeEventListener('touchmove', _touchLockHandler, {passive:false});
      _touchLockHandler = null;
      document.removeEventListener('wheel', wheelBlock, {passive:false});
    }
    function wheelBlock(e){
      if(modal.classList.contains('show')){
        // if wheel event target is inside modal-body, allow it, else prevent
        if(e.target && e.target.closest && e.target.closest('.modal-body')) return;
        e.preventDefault();
      }
    }
    // Ensure disabling cleanup on page unload
    window.addEventListener('beforeunload', ()=> disableModalTouchLock());

  </script>
</body>
</html>
